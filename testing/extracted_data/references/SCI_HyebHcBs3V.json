{
    "title": "HyebHcBs3V",
    "content": "The recent work of Super Characters method using two-dimensional word embedding achieved state-of-the-art results in text classification tasks, showcasing the promise of this new approach. This paper borrows the idea of Super Characters method and two-dimensional embedding, and proposes a method of generating conversational response for open domain dialogues. The experimental results on a public dataset shows that the proposed SuperChat method generates high quality responses. An interactive demo is ready to show at the workshop. And code will be available at github soon. Dialogue systems are important to enable machine to communicate with human through natural language. Given an input sentence, the dialogue system outputs the response sentence in a natural way which reads like humantalking. Previous work adopts an encoder-decoder architecture BID9 , and also the improved architectures with attention scheme added BID0 BID10 BID11 . In architectures with attention, the input sentence are encoded into vectors first, and then the encoded vectors are weighted by the attention score to get the context vector. The concatenation of the context vector and the previous output vector of the decoder, is fed into the decoder to predict the next words iteratively. Generally, the encoded vectors, the context vector, and the decoder output vector are all one-dimensional embedding, i.e. an array of real-valued numbers. The models used in decoder and encoder usually adopt RNN networks, such as bidirectional GRU BID0 Preliminary work. Under review by the International Conference on Machine Learning (ICML). Do not distribute. BID3 , LSTM BID6 , and bidirectional LSTM BID11 . However, the time complexity of the encoding part is very expensive. The recent work of Super Characters method has obtained state-of-the-art result for text classification on benchmark datasets in different languages, including English, Chinese, Japanese, and Korean. The Super Characters method is a two-step method. In the first step, the characters of the input text are drawn onto a blank image. Each character is represented by the two-dimensional embedding, i.e. an matrix of real-valued numbers. And the resulting image is called a Super Characters image. In the second step, Super Characters images are fed into a twodimensional CNN models for classification. Examples of two-dimensional CNN models are used in Computer Vison (CV) tasks, such as VGG BID7 , ResNet BID4 , SE-net BID5 and etc. in ImageNet BID1 .In this paper, we propose the SuperChat method for dialogue generation using the two-dimensional embedding. It has no encoding phase, but only has the decoding phase. The decoder is fine-tuned from the pretrained two-dimensional CNN models in the ImageNet competition. For each iteration of the decoding, the image of text through two-dimensional embedding of both the input sentence and the partial response sentence is directly fed into the decoder, without any compression into a concatenated vector as done in the previous work. The proposed SuperChat method is motivated by the two-dimensional embedding used in the Super Characters method. If the Super Characters method could keep the same good performance when the number of classes in the text classification problem becomes even larger, e.g. the size of dialogue vocabulary, then the Super Characters method should be able to address the task of conversational dialogue generation. This can be done by treating the input sentence and the partial response sentence as one combined text input. Figure 1 . SuperChat method illustration. The input Chinese sentence means \"Wher are you?\" in English, and the output given by the proposed SuperChat method is \"I am within your heart\". Figure 1 illustrates the proposed SuperChat method. The response sentence is predicted sequentially by predicting the next response word in multiple iterations. During each iteration, the input sentence and the current partial response sentence are embedded into an image through twodimentional embedding. The resulting image is called as a SuperChat image. And then this SuperChat image is fed into a CNN model to predict the next response word. In each SuperChat image, the upper portion corresponses to the input sentence, and the lower portion corresponses to the partial response sentence. At the beggining of the iteration, the partial response sentence is initiallized as null. The prediction of the first response word is based on the SuperChat image with only the input sentence embedded, and then the predicted word is added to the current partial response sentence. This iteration continues until End Of Sentence (EOS) appeared. Then, the final output would be a concatenation of the sequential output. The CNN model used in this method is fine-tuned from pretrained ImageNet models to predict the next response word with the generated SuperChat image as input. It can be trained end-to-end using large dialogue corpus. Thus the problem of predicting the next response word in dialogue generation is converted into an image classification problem. The training data is generated by labeling each SuperChat image as an example of the class indicated by its next response word. EOS is labeled to the SuperChat image if the response sentence is finished. The cut-length of sentences is high-related to the font size of each character. For fixed image size, the larger cutlength means smaller font size for each character, and vice versa. On the one hand, we want to cover long sentences, which means the cut-length should be big, so there will be variety in both the input dialogue and the response dialogue. On the other hand, if we set the cutlength too big, the font size of each character will be small, and there could be large blank area for short sentences, which is a waste of the space on the image. The cut-length should be configured according to the sentence length distribution. It should be also emphasized that the split of the image into input and response part could be not even. Depending on the statistics of the training data, maybe larger or smaller size could be assigned to response and input text. Also, the font size for each part does not need to be the same. Although the examples used in Figure 1 is illustrated with Chinese sentences, however, it can be also applied to other languages. For example, Asian languages such as Japanese and Korean, which has the same square shaped characters as in Chinese. For Latin languages where words may have variant length, SEW method BID8 could be used to convert the Latin languages also into the squared shape before applying the SuperChat method to generate the dialogue response. Beam search BID2 ) could be also used. In that case, instead of hard prediction for the first character, a soft prediction will be used to output all the possible sentences and one of the best will be selected as the final output. The dataset used is Simsimi 1 . This is a Chinese chitchat database. This data set contains 454,561 dialogue pairs. There are totally 5,523 characters used in the response sentences, of which 4996 are characters with frequency less than 1000. The top five frequency characters are \",\", \"\u6211\" (I), \"\u4f60\" (you), \"\u7684\" (of), and \"\u662f\" (is).Based on the distribution of the sentence length, we set cut length for input sentence at 18, and response cut length also at 18. So, altogether we have 36 characters within one SuperChat image, which could be a layout of 6 rows by 6 columns of characters. The input sentence takes the upper 3 rows, and the response sentence takes the lower 3 rows. For simplicity, we removed all the emoticons in the data set. In order to get enough samples for training, only characters whose frequency is not less than 1000 appearances are selected in the list of characters to predict. After this filtering, the remaining set is composed by the sentences with both input and response sentence length less than 18 characters, and all its characters in the list of the 528 frequent characters (including EOS). The resulting set is 178,192 pairs of dialogues, and a total of 989,087 SuperCharacter images are generated. We set our image size at three channels of 224x224 grey image, in order to use the pretrained models on ImageNet. We also added a margin area for the four edges in the SuperChat image, which means the first character will not start from the pixel location of (0, 0), but from (m, m) instead. Here m is the we set for the four edges. In this experiment, we set m = 16, which results in the remaining area is the square of 224\u221216x2 = 192 pixels. If we set same font size for both input and response sentence, it results in a font size of 192/6 = 32 pixels. That means, each character takes an area of 32x32 pixels. The fonts used is the \"simhei\". For each character, we split its labeled data into 75% for training and 25% for testing. Resulting in 739,289 training samples and 249,798 testing samples. SE-net-154 is used in this experiment. The pretrained model on ImageNet is used as initialization 2 . This model is fine-tuned on the generated SuperChat images just as an image classification task. The fine-tuning is done by simply modifying the last layer to 528, which is the size of the subset of the response vocabulary. The learning curve on the test data is shown in FIG0 .We can see that at the begining of the training, the curve climbs up quickly, and after it achieved 60%, the slope goes slowly and almost saturate to 64%. The x-axis is in unit of every 500 iterations, so totally it is one million iterations, with batch size of 5, wich accounts to about 7 epochs over the training data. In this paper, we propose the SuperChat method for dialogue response generation. It has no encoding, but only decodes the two-dimensional embedding of the input sentence and partial response sentence to predict the next response word iteratively. The pretrained two-dimensional CNN model is fine-tuned with the generated SuperChat images. The experimental results shows high quality response. An interactive demonstration is to show at the workshop TAB0 Submission and Formatting Instructions for ICML 2019 TAB0 . Sample response sentences generated by the SuperChat method on the Simsimi data set. Response Sentence 1 \"\u4f60\u6709\u7537\u670b\u53cb\u5417?\" \"\u6ca1\u6709,\u6211\u53ea\u6709\u8001\u516c\" \"Do you have boyfriend?\" \"No,I only have a husband\" 2 \"\u54fc!\u4f60\u4e0d\u60f3\u6211\u6211\u5c31\u4e0d\u548c\u4f60\u73a9\" \"\u6211\u5f88\u597d\u73a9\u7684\u8ddf\u6211\u73a9\u561b\u8ddf\u6211\u73a9\u561b\" \"Hmm! I won't play with you if you didn't miss me\" \"I am funny, please play with me, please\" 3 \"\u6211\u770b\u5230\u4f60\u7b2c\u4e00\u773c,\u5c31\u559c\u6b22\u4f60\u4e86\" \"\u6211\u4e5f\u559c\u6b22\u4f60\" \"The first time I saw you, I liked you\" \"I like you too\" 4 \"\u662f\u4ec0\u4e48\u610f\u601d\" \"\u4f60\u81ea\u5df1\u767e\u5ea6\u53bb\" \"What does that mean\" \"Go Baidu it yourself\" 5 \"\u6211\u53bb\u7761\u89c9\u4e86\" \"\u665a\u5b89\uff0c\u597d\u68a6\uff0c\u660e\u5929\u53eb\u4f60\u8d77\u5e8a\u54e6\" \"I am going sleep now\" \"Good dream, wake you up tomorrow\" 6 \"\u4f60\u4ec0\u4e48\u65f6\u5019\u7761\u89c9\" \"\u6211\u7b49\u4f60\u7761\u4e86\u518d\u7761\" \" When will you sleep\" \"I will wait untill after you sleep\" 7 \"\u65e0\u804a\u4e2d\" \"\u6211\u966a\u4f60\u804a\u5929\u5457\" \"I am bored\" \"Let's chitchat\" 8 \"\u6211\u597d\u96be\u8fc7,\u54ed\u7684\u90fd\u597d\u7d2f\" \"\u4e0d\u54ed\u4e0d\u54ed\uff0c\u54ed\u4e86\u4e0d\u597d\u770b\u4e86\" \"I am sad, and cried a lot\" \"Don't cry, not looking good when crying\" 9 \"\u95ee\u4f60\u5bb6\u54ea\u7684\" \"\u6211\u662f\u706b\u661f\u4eba\" \" Where are you from\" \"I am from Mars\" 10 \"\u5bf9\u554a\u4f60\u5403\u4ec0\u4e48\" \"\u4f60\u559c\u6b22\u5403\u4ec0\u4e48\uff0c\u6211\u5c31\u559c\u6b22\u5403\u4ec0\u4e48\" \"BTW what do you eat\" \"I eat whatever you like to eat\" 11 \"\u4e3a\u4f60\u4ed8\u51fa\u90a3\u79cd\u4f24\u5fc3\u4f60\u6c38\u8fdc\u4e0d\u4e86\u89e3\" \"\u6211\u4e0d\u4f1a\u9a97\u4f60\u3002\u73b0\u5728\u4e0d\u4f1a\u3001\u4ee5\u540e\u4e5f\u4e0d\u4f1a\u3002\" \" You won't know my heartbroken for you\" \"I won't lie to you. Not now, neither future.\" 12 \"\u90a3\u4f60\u662f\u7f8e\u5973\u4e0d\" \"\u6211\u662f\u7f8e\u5973\uff01\" \"So you are a beauty\" \"I am a beauty!\" 13 \"\u7761\u4e86\u5417\" \"\u6ca1\u6709\u554a\uff0c\u6211\u5728\u7b49\u4f60\u5462\u3002\" \"Are you asleep\" \"Nop, I am waiting for you.\" 14 \"\u4f60\u4f1a\u6253\u9e23\u4e0d\" \"\u5594\u5594\u5594\uff01\" \"Can you do rooster crowing\" \"Cockadoodledoo!\" 15 \"\u4f60\u7d2f\u4e48\" \"\u4f60\u7d2f\u5417\uff1f\u7d2f\u4e86\u65e9\u70b9\u7761\u5566\u3002\u4e56\u4e56\" \"Are you tied\" \"You tired? Then go sleep. Honey\" 16 \"\u6211\u60f3\u5979\u4e86,\u600e\u4e48\u529e\" \"\u53bb\u627e\u5979\u554a\uff01\" \"I miss her, what should I do\" \"Go see her!\" 17 \"\u4f60\u4ec0\u4e48\u90fd\u61c2\u5662\" \"\u6211\u4e0d\u77e5\u9053,\u4f46\u6709\u4e9b\u4e1c\u897f\u6211\u521a\u597d\u77e5\u9053\" \"You seem to know everything\" \"I don't konw, but it happens I know something\" 18 \"\u6211\u6628\u5929\u53d1\u72b6\u6001\u627e\u4f60\u3002\u4f60\u90fd\u4e0d\u7ed9\u56de\" \"\u6211\u9519\u4e86\" \"I sent message to you. But you didn't reply\" \"I apologize\" 19 \"\u8ba8\u538c\" \"\u6211\u8ba8\u538c\u4e00\u5207\u8ba8\u538c\u6211\u7684\u4eba\" \"Dislike you\" \"I dislike anyone who dislikes me\" 20 \"\u731c\u731c\u6211\u662f\u4ec0\u4e48\u661f\u5ea7\" \"\u53cc\u5b50\u5ea7\" \"Guess what is my constellation\"\"Gemini\""
}