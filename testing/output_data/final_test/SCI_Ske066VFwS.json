{
    "title": "Ske066VFwS",
    "content": "A recent approach using sequential variational auto-encoders demonstrated the ability to learn the dynamics of a single dynamical system for computations during reaching behavior in the brain, using spiking data modeled as a Poisson process. This approach is extended using a ladder method to infer a hierarchy of dynamical systems, capturing calcium dynamics and neural computation. Sequential variational auto-encoders can capture calcium dynamics and neural computation by inferring a hierarchy of dynamical systems. The model reconstructs Lorenz dynamics better than other methods and performs well with chaotic neural networks. However, it struggles to reconstruct firing rates compared to basic techniques for inferring spikes from calcium data. This shows the potential of VLAEs for modeling hierarchical dynamical systems in life sciences. Many datasets in the life sciences involve hierarchical dynamical systems, where lower-order systems generating data are influenced by higher-order systems. This is illustrated in figure 1A, where noisy observations x depend on the state z1 of a low-order system perturbed by inputs u1, which is also linked to the state z2 of a higher-order system perturbed by inputs u2. An example is in-vivo two-photon calcium imaging in neuroscience, allowing observation of multiple neurons simultaneously during experiments. Recent applications of sequential variational autoencoders to neural data analysis have been successful in inferring underlying computations in populations of cells in the motor cortex. Neural computation is characterized as low-dimensional dynamic factors in non-hierarchical dynamical systems. In a study by Pandarinath et al. (2018), dynamic factors in non-hierarchical dynamical systems were trained to generate intensity functions explaining spike rates following a Poisson process. These factors could decode reaching behavior in macaques and humans more accurately than other methods. Two-photon calcium imaging presents challenges in identifying latent spike trains in fluorescence traces, addressed through methods like deconvolution and variational inference. The frequency of events can be modeled as a hierarchy of dynamical systems. In a hierarchical dynamical systems approach, a method is proposed to extend LFADS for accommodating calcium activity. The model, a variational ladder autoencoder with recurrent neural networks, can infer latent dynamics and spike trains from observed calcium fluorescence signals. It unifies LFADS and DeepSpike, utilizing VAEs in neuroscience. The VLAE approach is chosen to avoid reconstructing data solely from lower-order features by separating latent variables. Model hyperparameters are detailed in table A1. The dynamical system underlying calcium event frequency is similar to LFADS. Initial conditions and external inputs are modeled as Gaussian distributions. The dynamical system is modeled by a GRU, and low dimensional factors are calculated as a linear transformation of the generator hidden state. The factors f t are calculated as a linear transformation of the generator hidden state. Inferred spike counts s t are generated by sampling z t from Gaussian distributions and projecting them through an affine transformation. A simple model of calcium dynamics is assumed, with parameters measured from data. The calcium fluorescence signal x t is mapped onto the parameters. The calcium fluorescence signal x t is used in calcium imaging experiments. Variational posterior distributions Q(z t |x), Q(g 0 |x), Q(u t |x) are modelled as Gaussians. Hidden states from bidirectional GRUs are used to parameterize these distributions. VLAEs have the same ELBO formulation as VAEs, maintaining a similar cost function despite the hierarchical latent space. The cost function for VLAEs is similar to LFADS, with parameters optimized using ADAM. Latent variables are treated as independent, with hierarchy imposed in deterministic paths. Training involves a decreasing learning rate and KL divergence. The VLAE model utilized a scaling factor of 0.95 for plateaus in training error, with KL and L2 terms gradually increased. Warm-up for deeper parameters was delayed until shallower parameters were completed. The model was tested on synthetic data with Lorenz dynamics embedded in calcium fluorescence transients, measuring performance in uncovering dynamics, reconstructing calcium transient rates, and spike counts contributing to fluorescence signal increases. The model was tested on synthetic data with Lorenz dynamics embedded in calcium fluorescence transients, measuring performance in uncovering dynamics, reconstructing calcium transient rates, and spike counts contributing to fluorescence signal increases. The model was compared against ground-truth spike counts, a deconvolution algorithm, and models reconstructing fluorescence traces, intensity functions, spikes, and Lorenz dynamics. The model provides a close fit to fluorescence traces, intensity functions, and Lorenz dynamics. It captures spike-timing and outperforms other models in reconstructing fluorescence traces. The Gaussian and Edgeworth LFADS models perform poorly due to their approach in reconstructing fluorescence. Additionally, the model performs almost as well as LFADS in reconstructing Lorenz dynamics. Our model performs well in reconstructing latent dynamics, although it does not outperform the deconvolution method OASIS in reconstructing spike trains. The deconvolution algorithm performs better in synthetic datasets compared to real datasets with known ground-truth spiking. Further assessment is needed to determine if constraining reconstructed spikes by latent dynamics can mitigate errors in spike train reconstruction. The study discusses the challenges of accurately reproducing spike trains from calcium fluorescence activity in neural recordings. The model was tested on synthetic data from a neural network with chaotic dynamics to assess its performance. The study evaluated the model's performance in reconstructing spike trains from calcium imaging experiments. The fluorescence traces and spike trains were reconstructed well, but intensity functions showed high noise levels. Factors and external inputs also exhibited noise, possibly due to difficulty inferring external inputs accurately. The model performed well in reconstructing fluorescence signals and reasonably well in reconstructing spikes. Our hierarchical recurrent variational autoencoder model outperformed other methods in reconstructing latent dynamics, spike trains, and calcium fluorescence traces in a synthetic dataset. Further evaluation on additional benchmark data is needed to validate our approach. The model, trained end-to-end, shows potential for extending to reconstructing raw 2-photon imaging videos to uncover latent dynamics. Our hierarchical model can uncover latent dynamics from 2-photon imaging videos, benefiting neuroscientists by capturing dendritic morphological diversity. It provides measures of uncertainty in latent dynamics and spike trains, improving inference despite less accurate spike train reconstructions compared to OASIS. Future work aims to enhance the model's ability to capture hierarchical relationships. The hierarchical model can uncover latent dynamics from 2-photon imaging videos in neuroscience, benefiting neuroscientists by capturing dendritic morphological diversity. The model aims to investigate hierarchical dynamical systems' utility in uncovering structure in datasets outside this domain."
}