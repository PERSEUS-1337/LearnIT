{
    "title": "r1x4BnCqKX",
    "content": "Chemical reactions involve the redistribution of electrons in molecules, depicted using arrow-pushing diagrams. The ELECTRO model predicts electron movement sequences from raw reaction data, offering benefits like easy interpretation for chemists and incorporating chemistry constraints. It extracts reaction paths from atom-mapped reaction SMILES strings and shows excellent performance on the USPTO reaction dataset. Our model shows strong performance on the USPTO reaction dataset, demonstrating a basic knowledge of chemistry. Predicting chemical reaction products is crucial for medicine and materials manufacturing. Chemical reactions involve electron rearrangement, known as the reaction mechanism, which determines product formation and provides insight at an atomistic level. Chemists use a qualitative model called \"arrow pushing\" to simplify electron shifts in chemical reactions. Machine learning models have been developed to predict reaction products directly, using graph-based or machine learning approaches. In this paper, a machine learning model is proposed to predict reaction mechanisms for organic reactions, which is more interpretable and allows for easier encoding of chemistry constraints. Previous approaches have relied on hand-coded heuristics and quantum mechanics. The model ELECTRO predicts electron paths in molecules, trained on unannotated reaction datasets like USPTO. It achieves impressive results and learns additional chemical properties. The paper discusses molecules, chemical reactions, and machine learning in predicting reaction outcomes, focusing on linear electron flow (LEF). Linear electron flow (LEF) reactions are a crucial subclass of chemical reactions involving the movement of electrons to form new molecules. This process includes breaking and forming chemical bonds, leading to the transformation of reactants into products. Machine learning plays a role in understanding and predicting these reactions. Machine learning in reaction prediction can be categorized into product prediction and mechanism prediction. Product prediction involves predicting reaction products, while mechanism prediction determines how reactants react. Recent methods combine machine learning and molecular rewriting rules for product prediction. These models can be interpretable but brittle. Another approach uses a neural network based on the Weisfeiler-Lehman algorithm for graph testing. The WLDN algorithm constructs a neural network for testing graph isomorphism and selecting atoms for reactions. It ranks potential products based on chemically-valid bond changes. Another method, Seq2Seq, predicts product SMILES using reactant SMILES strings. While Seq2Seq is end-to-end trainable, the SMILES representation is fragile due to single character limitations. In this work, the WLDN and Seq2Seq methods are compared with state-of-the-art product prediction techniques. Previous works by Fooshee et al. and Kayala et al. have also used machine learning to predict reaction mechanisms based on electron donors and acceptors. These methods have been tested on small expert-curated datasets. In contrast to previous works on small expert-curated datasets, this study focuses on learning reactions from noisy large-scale public datasets lacking essential reaction condition information. The comparison with existing methods is not feasible due to data unavailability, highlighting the need for end-to-end models subject to chemical constraints and mechanistic learning in reaction prediction. In this work, the focus is on modeling reaction mechanisms with linear electron flow for interpretability, sparsity, and generalization benefits. The proposed approach aims to classify reactions based on electron-pushing arrows, with a focus on heterolytic reactions involving pairs of electrons. The focus is on modeling reaction mechanisms with linear electron flow for interpretability, sparsity, and generalization benefits. LEF reactions involve pairs of electrons moving along a linear path, removing existing bonds and forming new ones in a sequence. Arrow pushing diagrams represent this electron movement, differentiating from pericyclic reactions. The process starts by moving electrons between atoms, alternating between removing and forming bonds. The text discusses a generative model called ELECTRO for predicting reaction mechanisms, specifically focusing on linear electron flow (LEF) reactions. The model is fully differentiable and can learn chemical knowledge such as functional group selectivity without explicit training. It proposes a probabilistic model for electron movement in LEF reactions, where pairs of electrons move along a linear path to form new bonds. The text introduces a generative model called ELECTRO for predicting reaction mechanisms in linear electron flow (LEF) reactions. It proposes a distribution over electron movements in reactions, involving the transformation of reactant graphs into product graphs via a series of electron actions. The model aims to learn the starting location distribution and electron movement patterns to predict the outcome of reactions. The model ELECTRO aims to predict reaction mechanisms in linear electron flow reactions by learning starting location distribution and electron movement patterns using deep graph neural networks. The Gated Graph Neural Network (GGNN) is used to compute graph embeddings for molecule sets, which are invariant to node ordering. The model represents characteristic probabilities of next actions as colored circles over each atom, with some actions being disallowed on certain steps. The graph embedding function used is inspired by Li et al. (2018) and described in detail in the appendix. The feedforward neural network computes logits x, normalized into probabilities by the softmax function. Electron movement in LEF reactions depends on intermediate molecules, previous actions, and time. The electron movement distribution is learned based on these factors. The distribution can be split into two based on the parity of time: remove bond step distribution for odd t and add step distribution for even t. The distribution of electron movement in LEF reactions is computed by a feedforward neural network, split into remove bond and add bond step distributions based on the parity of time. Mask vectors zero-out probabilities for certain atoms and prevent the model from stalling. A latent variable c t determines whether the reaction continues or terminates. The reaction in LEF reactions is controlled by a neural network, with a latent variable determining if it continues or stops. An upper bound is set on the number of reaction steps, and specific rules govern the selection of atoms and stopping points in the reaction process. The reaction in LEF reactions is controlled by a neural network, with a latent variable determining if it continues or stops. An upper bound is set on the number of reaction steps, and specific rules govern the selection of atoms and stopping points in the reaction process. The final distribution learned is the continuation distribution p cont \u03b8 (c t | M t ). The probability of a path P 0:T with the distribution p \u03b8 (P 0:T | M 0 , M e ) can be defined given these distributions. The parameters \u03b8 of parameterized functions, including node embeddings, are learned by maximizing log likelihood of a full path log p \u03b8 (P 0. Training is done using electron path data and intermediate products extracted from training data. Models are trained using Adam with an initial learning rate of 10 \u22124. Once trained, the model can sample chemically-valid paths given reactants and reagents. The model uses a modified beam search to find a ranked list of top-K predicted paths. Evaluation is done on a collection of chemical reactions from the US patent database. The data consists of reaction SMILES strings and bond change lists. The text describes data processing techniques using RDKit to identify reagents, reactions with LEF topology, and extract an electron path from reaction SMILES strings. It explains the separation of reactants, reagents, and products in chemical reactions, highlighting the challenge of differentiating between reagents and reactants in the USPTO dataset. The USPTO dataset is preprocessed to separate reagents from reactants using a method outlined in Schwaller et al. This allows proper modeling of molecules that do not contribute to the reaction. 73% of the dataset consists of reactions with LEF topology, which are identified and electron paths extracted as shown in FIG3. In the USPTO dataset, 73% of reactions are LEF reactions, with 349,898 total reactions. ELECTRO is evaluated for mechanism and product prediction, with a version called ELECTRO-LITE that ignores reagent information to assess its importance. An example shows how a SMILES reaction string is turned into an ordered electron path. The text explains the process of converting a SMILES reaction string into an ordered electron path for training ELECTRO. It involves identifying bond changes, joining them up, and assigning a direction based on charge gain or loss. If details are missing, electronegativity is used to estimate the path direction. The text discusses using electronegativity to determine the direction of an electron path for training ELECTRO. Paths with specific steps are used for training, while those without are discarded. The model can predict reactions accurately even with missing reagents. The focus is on obtaining the correct sequence of electron steps for mechanism prediction. The text emphasizes the importance of obtaining the accurate sequence of electron steps for mechanism prediction. It discusses how multiple sequences of integers can correspond to chemically-identical electron paths due to symmetries in molecules. The model's predictive accuracy is underestimated as a result. Recent approaches to product prediction have evaluated if the major product matches predicted candidates, regardless of mechanism. The top-5 accuracy may include different electron paths leading to the same product. To determine if the model predicts the same major product as in the test data, a graph isomorphism problem is solved by applying predicted electron paths to reactants to produce a product graph. The study evaluates models trained on the USPTO training set and tested on a subset of reactions. They also train models from scratch using the OpenNMT library. The models correctly predict trends in nucleophilic substitutions and Suzuki-coupling reactions. The study evaluates models trained on the USPTO training set and tested on a subset of reactions. They also train models from scratch using the OpenNMT library. The models correctly predict trends in nucleophilic substitutions and Suzuki-coupling reactions. The procedure involves canonicalizing product SMILES for predictions found by beam search over electron paths, removing duplicates, and comparing with a state-of-the-art graph-based method. Overall, ELECTRO outperforms other approaches on the task, achieving 87% top-1 accuracy and 95.9% top-5 accuracy. Reagent information is crucial for predicting reaction paths, as it helps in disambiguating plausible reactions. Chemistry students rely on heuristics and trends to predict selectivity in reactions involving complex molecules with multiple reactive functional groups. The model ELECTRO has shown high accuracy in predicting chemical reactions by learning heuristics and trends from data. It can currently only predict reactions with LEF topology, but future work aims to expand its capabilities to other electron shift topologies. The model ELECTRO aims to expand its capabilities to work with different electron shift topologies in chemical reactions. This could be achieved by outputting multiple paths or allowing multiple electron movements. To improve accuracy, labeled mechanism paths from finer datasets containing intermediates could be used. Additionally, creating mechanistic intermediates using quantum mechanical calculations may help address this limitation. In this paper, the model ELECTRO is proposed for predicting electron paths in reactions with linear electron flow, aiding in understanding molecule reactions. The model produces interpretable output for chemists and leverages the sparsity and compositionality of chemical reactions. It also enables reaction product prediction, outperforming strong baselines. The model ELECTRO aids in predicting electron paths in reactions, outperforming baselines. Challenges in evaluating the model include symmetry affecting electron paths, as shown in Figure 6. Existing work on node and graph embeddings is briefly reviewed, with specific details on implementation. Figure 7 visualizes these techniques. The GGNNs use recurrent operations to find node embeddings for atoms in molecules, updating messages associated with each node in a recursive manner. The functions N e1 (v), N e2 (v), N e3 (v) index nodes connected by single, double, and triple bonds to node v. In GGNNs, nodes are indexed by N e1 (v), N e2 (v), N e3 (v) for single, double, and triple bonds to node v. Linear transformations f single (\u00b7), f double (\u00b7), f triple (\u00b7) are used for message passing in S steps. Node embeddings are updated iteratively using messages from neighbors, forming q-dimensional vectors. The GGNN utilizes node embeddings and atom features as input for message passing in S steps. Reagent information can be incorporated at each step to improve accuracy on mechanism prediction tasks. The model achieves top-5 accuracy of 94.6% on reaction product prediction task. Training details include the use of Adam optimizer with a learning rate decay after 5 and 9 epochs. The model extracts reactions with linear electron flow topology from USPTO SMILES reaction strings. The model achieves high accuracy on reaction product prediction by extracting reactions with linear electron flow topology from USPTO SMILES reaction strings. The path formation in reactions involves bond changes and examining changes in properties of atoms at the ends to determine electron flow direction. The path formation in reactions involves bond changes and examining changes in properties of atoms to determine electron flow direction. Electronegativity is used when data on bond changes is unavailable. Bond changes are analyzed to ensure the path alternates between add and remove steps. The path formation in reactions involves bond changes and examining changes in properties of atoms to determine electron flow direction. Electronegativity is used when data on bond changes is unavailable. Bond changes are analyzed to ensure the path alternates between add and remove steps. At predict time, beam search is used to find high probable chemically valid paths from the model, with details in Algorithm 2. The operation for ELECTRO takes 0.337s per reaction, with filtering down to the top K most promising actions. The model predicts valid chemical paths and their probabilities, sorted by the latter. It takes 0.007s to compute the log likelihood of a reaction with access to intermediate steps. Examples of predicted paths are shown in figures, demonstrating the model's ability to learn chemical trends. The model accurately predicts chemical paths and probabilities, showcasing its ability to learn chemical trends by testing on textbook reactions and examples from the USPTO dataset. The model correctly identifies expected products and regioselectivity in electrophilic aromatic substitutions."
}